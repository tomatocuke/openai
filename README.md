### æœ€è¿‘æŒç»­ä¼˜åŒ–ä¸­ï¼Œå–œæ¬¢çš„åŒå­¦ç»™ä¸ªğŸŒŸå…³æ³¨ä¸€ä¸‹

### ä¸€ã€ä»‹ç»
- èƒ½å¹²ä»€ä¹ˆï¼Ÿ 
  - é€šè¿‡è°ƒç”¨`OpenAI`çš„æ¥å£æ™ºèƒ½å›ç­”é—®é¢˜ã€‚
  - å¯ä»¥ç›´æ¥apiè°ƒç”¨
  - å¯ä»¥ç”¨ä½œå…¬ä¼—å·è‡ªåŠ¨å›å¤ã€‚ï¼ˆæç¤ºï¼šä»…ç”¨äºä¸ªäººå¨±ä¹ä½“éªŒï¼Œä¸é€‚åˆå•†ä¸šç”¨é€”ï¼‰
- æ˜¯`ChatGPT`å—ï¼Ÿ  ä¸æ˜¯ã€‚`ChatGPT`åŸºäºGPT-3.5ï¼Œæœ¬é¡¹ç›®æ˜¯è°ƒç”¨GPT-3ï¼Œæœ‰éå¸¸å¤§å·®è·ã€‚ç°åœ¨`ChatGPT`è¿˜æ²¡å¼€æ”¾æ¥å£ï¼Œå®‰å…¨é™åˆ¶å¾ˆé«˜ï¼Œç°æœ‰å¸‚é¢éƒ½æ˜¯GPT-3ã€‚
- å…è´¹å—ï¼Ÿä¸ç®—ï¼Œ`OpenAI`è´¦å·èµ é€18$ï¼Œé™æœŸä½¿ç”¨ã€‚ æ¶ˆè€—æ ¹æ®é—®é¢˜å’Œå›å¤é•¿åº¦è®¡ç®—ã€‚
- æœ‰ä»€ä¹ˆä¸è¶³ï¼Ÿ 
  - å›å¤å†…å®¹å‡†ç¡®åº¦ä»…ä¾›å‚è€ƒï¼Œæ›´é€‚åˆå¼€æ”¾æ€§é—®é¢˜ã€‚ 
  - ä¸æ”¯æŒä¸Šä¸‹æ–‡ã€‚ (ä¹Ÿæ–¹ä¾¿åšï¼Œä½†æ˜¯èŠ±è´¹æ›´å¤šçš„tokensï¼‰
  - é€Ÿåº¦å’Œå›å¤é•¿åº¦å¾ˆéš¾å…¼å¾—ã€‚å¦‚æœæ˜¯è®¢é˜…å·ï¼Œåªèƒ½è¢«åŠ¨å›å¤ï¼Œ[é™åˆ¶æœ€ä¹…15såšå‡ºå›å¤](https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Passive_user_reply_message.html)ï¼Œå›å¤å¯èƒ½è¶…æ—¶æˆ–è€…æ˜¯æˆªæ–­çš„(åšäº†ç¼“å­˜ä¼˜åŒ–ï¼Œå¯ç¨ç­‰å†æ¬¡æé—®ç›´æ¥è·å¾—ç­”æ¡ˆ)  ã€‚ éè®¢é˜…å·ï¼Œ48å°æ—¶å†…æœ‰20æ¡ä¸»åŠ¨å›å¤é¢åº¦ï¼Œè¿™ä¸ªç‰ˆæœ¬ä¹Ÿå¼€å‘äº†ï¼Œåœ¨devåˆ†æ”¯ï¼Œè¿˜ä¸ç¨³å®šã€‚ 
- é£é™©ã€‚ä¾æ‰˜äºå…¬ä¼—å·å­˜åœ¨ä¸€å®šé£é™©ã€‚ æˆ‘å·²åŠ äº†[æ•æ„Ÿè¯æ£€æµ‹](https://github.com/tomatocuke/sieve) ï¼Œä½†ä¸æ¸…æ¥šå¾®ä¿¡å…·ä½“æœºåˆ¶æ­¤ä¸¾æ˜¯å¦æœ‰æ•ˆã€‚
- ä½“éªŒã€‚å…³æ³¨å…¬ä¼—å·`æ ç‚¹æ `å°è¯•æé—®ï¼Œè¿™ä»…æ˜¯ä¸ªäººå¨±ä¹å·ï¼Œä¸æ¨é€ã€‚


### å…¬ä¼—å·éƒ¨ç½²
> å¦‚æœä»…ç”¨äºapiè°ƒç”¨ï¼Œå¿½ç•¥ä¸‹æ–‡æœ‰å…³å¾®ä¿¡å…¬ä¼—å·çš„è®¾ç½®ã€å¿½ç•¥ WX_TOKEN å‚æ•°
1. è·å–`API_KEY`ã€‚[OpenAI](https://beta.openai.com/account/api-keys) ï¼ˆå¦‚æœè®¿é—®è¢«æ‹’ç»ï¼Œæ³¨æ„å…¨å±€ä»£ç†ï¼Œæ‰“å¼€è°ƒè¯•ï¼ŒApplicationæ¸…é™¤LocalStorageååˆ·æ–°ï¼Œå®æµ‹å¯ä»¥ï¼‰
2. è·å–å¾®ä¿¡å…¬ä¼—å·`ä»¤ç‰ŒToken`ï¼š[å¾®ä¿¡å…¬ä¼—å¹³å°](https://mp.weixin.qq.com/)->åŸºæœ¬é…ç½®->æœåŠ¡å™¨é…ç½®->ä»¤ç‰Œ(Token)  (ä¸ä½¿ç”¨å…¬ä¼—å·å¯è°ƒè¿‡)
3. ä½¿ç”¨ä»¥ä¸Šå‚æ•°å¯åŠ¨æœåŠ¡ï¼Œä»¥ä¸‹ä¸¤ç§æ–¹å¼é€‰å…¶ä¸€éƒ¨ç½²ã€‚(æ­¤å¤„ä¸¾ä¾‹ç«¯å£9001ï¼Œå¦‚æœç”¨å…¬ä¼—å·ä¸”æ— åŸŸåé¡»ç”¨80ç«¯å£)
  - Docker
    ```bash
    docker run -p 9001:8080 -e API_KEY=xxx -e WX_TOKEN=xxx -d -v $PWD/log:/app/log tomatocuke/openai
    ```
  - Golang
    ```bash 
    git clone https://github.com/tomatocuke/openai.git
    cd openai
    go run main.go -PORT=9001 -API_KEY=xxx -WX_TOKEN=xxx 
    ```
4. å¯åŠ¨æœåŠ¡åç®€å•æµ‹è¯• `curl 'http://127.0.0.1:9001/test?msg=ä¸­å›½åœ¨å“ªä¸ªæ´²'` 
5. æŸ¥çœ‹æ—¥å¿— `tail ./log/data.log`
6. å…¬ä¼—å·é…ç½®ã€‚ 
  - æ— åŸŸåã€‚é¡»ç”¨80ç«¯å£éƒ¨ç½²ï¼ŒæœåŠ¡å™¨åœ°å€(URL)å¡«å†™ `http://æœåŠ¡å™¨IP/wx`ã€‚
  - æœ‰åŸŸåã€‚nginxé…ç½®å‚è€ƒ
    ```conf
    server {
      listen 80;
      server_name åŸŸå; #ä½ çš„åŸŸåï¼Œä¸å¸¦httpï¼Œä¾‹: abc.com

      location /openai/ {
        proxy_pass http://127.0.0.1:9001/; # æœåŠ¡ç«¯å£å·
      }
    }
    ```
    é‡æ–°åŠ è½½nginxé…ç½®`nginx -s reload`åï¼Œå…¬ä¼—å·æœåŠ¡å™¨åœ°å€å¡«å†™: `http://åŸŸå/openai/wx`ã€‚
    å¯ç”¨å…¬ä¼—å·æœåŠ¡å™¨é…ç½®  (åˆæ¬¡è®¾ç½®å¯èƒ½è¦ç­‰å¾…2åˆ†é’Ÿç”Ÿæ•ˆï¼‰
7. ç›´æ¥è°ƒç”¨api `curl 'http://åŸŸå/openai/test?msg=ä¸­å›½åœ¨å“ªä¸ªæ´²'`
    

### ä¸‰ã€å…¶ä»–
- æœ‰ä»€ä¹ˆé—®é¢˜æˆ‘githubå¯èƒ½ä¸åŠæ—¶æŸ¥çœ‹ï¼ŒåŠ QQ:`772532526`
